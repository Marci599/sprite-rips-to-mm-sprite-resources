<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="FramesToMMSpriteResource.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:FramesToMMSpriteResource"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
 
    mc:Ignorable="d"
    Title="Frames to MM sprite resources">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>


    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>


            <TreeView x:Name="TreeViewControl" Grid.Row="0" Margin="0 2 0 0" MinWidth="200">
                <TreeView.ItemContainerStyle>
                    <Style TargetType="TreeViewItem">

                    </Style>
                </TreeView.ItemContainerStyle>
                <TreeView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <FontIcon Glyph="{Binding Content.IconGlyph}" Width="20" Height="32" Margin="-4 0 12 0" Opacity="0.67" FontSize="18"/>
                            <TextBlock Text="{Binding Content.Text}" VerticalAlignment="Center" Margin="0 0 18 0"/>
                        </StackPanel>
                    </DataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
            <StackPanel Grid.Row="1" VerticalAlignment="Bottom" Spacing="0" Padding="4" HorizontalAlignment="Stretch">

                <Rectangle Style="{StaticResource GroupDividerStyle}" Margin="8 -4 8 4"/>
                <ToggleButton x:Name="SettingsToggleButton" Style="{StaticResource TreeLikeNavToggleButtonStyle}" Padding="16 10 16 10" HorizontalAlignment="Stretch" HorizontalContentAlignment="left" Click="ClickSettings">
                    <StackPanel Orientation="Horizontal" Spacing="14">
                        <FontIcon Glyph="&#xE713;" Opacity="0.67" FontSize="18"/>
                        <TextBlock Text="Settings &amp; Help"/>
                    </StackPanel>
                </ToggleButton>
            </StackPanel>

            <StackPanel x:Name="TreeViewPlaceHolderStackPanel" VerticalAlignment="Center" Spacing="12">
                <TextBlock x:Name="TreeViewPlaceHolderText" Text="Could not display hierarchy" HorizontalAlignment="Center"/>
                <Button x:Name="TreeViewPlaceHolderButton" Content="Generate hierarchy" HorizontalAlignment="Center" Visibility="Collapsed" Click="ClickGenerateHieararchy"/>
            </StackPanel>

        </Grid>


        <!-- Content area -->
        <Grid Grid.Column="1" RowSpacing="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <BreadcrumbBar
                x:Name="HeaderBreadcrumbBar"
                Grid.Row="0"
                Margin="0 2 0 20">
                <BreadcrumbBar.Resources>
                    <!-- Ez vezérli a kis nyíl méretét -->
                    <x:Double x:Key="BreadcrumbBarChevronFontSize">18</x:Double>
      
                </BreadcrumbBar.Resources>
                <BreadcrumbBar.ItemTemplate>
                    <DataTemplate x:DataType="x:String">
                        <TextBlock
                            Margin="10 0 10 0"
                            Text="{x:Bind}"
                            FontSize="26"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"/>
                    </DataTemplate>
                </BreadcrumbBar.ItemTemplate>
            </BreadcrumbBar>

            <Border Grid.Row="1" Background="{ThemeResource LayerFillColorDefaultBrush}" CornerRadius="20 0 0 0">
                <Grid>
                    <!-- GameTheme Panel (default visible) -->
                    <Grid x:Name="GameThemePanel" Visibility="Visible">
                        <ScrollViewer>
                            <StackPanel Padding="20 14 20 20">
                                <StackPanel Spacing="4" MaxWidth="1000">
                                    <CheckBox x:Name="IsHdCheckBox" Content="Is HD" IsChecked="True"/>
                                    <TextBlock Text="If enabled @2x pngs will be generated and .sprites files will be adjusted for that."  Style="{StaticResource HelperTextStyle}"/>
                                </StackPanel>
                                <Grid
                                  Height="{Binding ActualHeight, ElementName=SaveBarBorder}"
                                  IsHitTestVisible="False"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                    <!-- Subject Panel (default visible) -->
                    <Grid x:Name="SubjectPanel" Visibility="Collapsed">
                        <ScrollViewer>
                            <StackPanel Padding="20 20 20 20">
                                <Grid ColumnSpacing="10" MaxWidth="1000">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Processing Group -->
                                    <Border Grid.Column="0" Style="{StaticResource CardBorderStyle}">
                                        <StackPanel Spacing="12">
                                            <TextBlock Text="Processing" Style="{StaticResource SectionHeaderStyle}"/>

                                            <Rectangle Style="{StaticResource GroupDividerStyle}"/>

                                            <NumberBox x:Name="ResizeTextBox" PlaceholderText="100" Header="Resize to percent"/>

                                            <StackPanel Spacing="4">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="32"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBox x:Name="ColorTextBox" Grid.Column="0" PlaceholderText="#00000000" Header="Background color" Style="{StaticResource InsetTextBoxStyle}" CornerRadius="4 0 0 4"/>
                                                    <Border x:Name="ColorPreviewBorder" Grid.Column="1" BorderThickness="1" Background="White" CornerRadius="0 4 4 0" Height="32" VerticalAlignment="Bottom"/>
                                                </Grid>

                                                <TextBlock Text="If already transparent, leave it blank" Style="{StaticResource HelperTextStyle}"/>
                                            </StackPanel>

                                            <NumberBox x:Name="ThresholdTextBox" PlaceholderText="100" Header="Color threshold"/>

                                            <CheckBox x:Name="RemoveBackgroundCheckBox" Content="Remove background" IsChecked="True"/>
                                            <StackPanel Spacing="4">
                                                <CheckBox x:Name="CropSpritesCheckBox" Content="Crop sprites" IsChecked="True"/>
                                                <TextBlock Text="Cropping reduces file size"  Style="{StaticResource HelperTextStyle}"/>
                                                <TextBlock Text="Cropping is based on the bg color and threshold"  Style="{StaticResource HelperTextStyle}"/>
                                            </StackPanel>

                                        </StackPanel>
                                    </Border>

                                    <!-- Sheet Dimensions Group -->
                                    <Border Grid.Column="1" Style="{StaticResource CardBorderStyle}">
                                        <StackPanel Spacing="12">
                                            <TextBlock Text="Sheet dimensions" Style="{StaticResource SectionHeaderStyle}"/>
                                            <Rectangle Style="{StaticResource GroupDividerStyle}"/>

                                            <NumberBox x:Name="SheetWidthTextBox" PlaceholderText="Auto" Header="Width"/>

                                            <StackPanel Spacing="4">
                                                <NumberBox x:Name="SheetHeightTextBox" PlaceholderText="Auto" Header="Height"/>
                                                <TextBlock Text="For automatic sizing, leave it blank" Style="{StaticResource HelperTextStyle}"/>
                                            </StackPanel>

                                        </StackPanel>
                                    </Border>
                                </Grid>
                                <Grid
                                  Height="{Binding ActualHeight, ElementName=SaveBarBorder}"
                                  IsHitTestVisible="False"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>

                    <!-- Animations Panel (hidden by default) -->
                    <Grid x:Name="AnimationsPanel" Visibility="Collapsed">
                        <ScrollViewer>
                            <StackPanel x:Name="AnimationDetailPanel" Spacing="10" Padding="20 14 20 20">
                                <StackPanel Spacing="4" MaxWidth="1000">
                                    <CheckBox x:Name="RegenerateCheckBox" Content="Regenerate frame properties" IsChecked="True"/>
                                    <TextBlock Text="If disabled, manually modified offsets and sub-positions will remain unchanged."  Style="{StaticResource HelperTextStyle}"/>
                                </StackPanel>

                                <NumberBox x:Name="DelayTextBox" PlaceholderText="1" Header="Delay" MaxWidth="1000"/>

                                <Border Style="{StaticResource CardBorderStyle}" MaxWidth="1000">
                                    <StackPanel Spacing="12">
                                        <TextBlock Text="Offset" Style="{StaticResource SectionHeaderStyle}"/>
                                        <Rectangle Style="{StaticResource GroupDividerStyle}"/>
                                        <StackPanel Spacing="4">
                                            <Grid ColumnSpacing="8">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>

                                                <NumberBox Grid.Column="0" x:Name="OffsetXTextBox" PlaceholderText="0" Header="X"/>
                                                <NumberBox Grid.Column="1" x:Name="OffsetYTextBox" PlaceholderText="0" Header="Y"/>

                                            </Grid>
                                            <TextBlock Text="Adjusts the offset for every sprite within the selected animation"  Style="{StaticResource HelperTextStyle}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource CardBorderStyle}" MaxWidth="1000">
                                    <StackPanel Spacing="12">
                                        <TextBlock Text="Recover cropped offset" Style="{StaticResource SectionHeaderStyle}"/>
                                        <Rectangle Style="{StaticResource GroupDividerStyle}"/>
                                        <StackPanel Spacing="4">
                                            <Grid ColumnSpacing="8">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <CheckBox Grid.Column="0" x:Name="RecoverXCheckBox" Content="X" IsChecked="True"/>
                                                <CheckBox Grid.Column="1" x:Name="RecoverYCheckBox" Content="Y" IsChecked="True"/>
                                            </Grid>
                                            <TextBlock Text="If enabled, the offsets will be adjusted to account for any cropping that was done."  Style="{StaticResource HelperTextStyle}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <Grid
                                  Height="{Binding ActualHeight, ElementName=SaveBarBorder}"
                                  IsHitTestVisible="False"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>

                    <!-- HelpPanel -->
                    <Grid x:Name="HelpPanel" Visibility="Collapsed">
                        <ScrollViewer>
                            <StackPanel Padding="20 20 20 20">
                                <Grid ColumnSpacing="10" MaxWidth="1000">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Processing Group -->
                                    <Border Grid.Column="0" Style="{StaticResource CardBorderStyle}">
                                        <StackPanel Spacing="12">
                                            <TextBlock Text="Settings" Style="{StaticResource SectionHeaderStyle}"/>

                                            <Rectangle Style="{StaticResource GroupDividerStyle}"/>


                                            <StackPanel Spacing="4">
                                                <TextBox x:Name="WorkingPathTextBox" Grid.Column="0" PlaceholderText="Default" Header="Working directory path"/>
                                                <TextBlock Text="To use the same directory the program is in, leave it blank"  Style="{StaticResource HelperTextStyle}"/>
                                            </StackPanel>

                                        </StackPanel>
                                    </Border>

                                    <!-- Sheet Dimensions Group -->
                                    <Border Grid.Column="1" Style="{StaticResource CardBorderStyle}">
                                        <StackPanel Spacing="12">
                                            <TextBlock Text="Frames to MM sprite resources v2.0.0" Style="{StaticResource SectionHeaderStyle}"/>
                                            <Rectangle Style="{StaticResource GroupDividerStyle}"/>


                                            <TextBlock Text="Created by Marci599 for Mario Multiverse (created by neoarc)."/>
                                            <TextBlock Text="Check GitHub repository for help, updates and issues:"/>
                                            <HyperlinkButton NavigateUri = "https://github.com/Marci599/sprite-rips-to-mm-sprite-resources" Margin="-12 -6 -12 -4">
                                                <TextBlock Text="github.com/Marci599/sprite-rips-to-mm-sprite-resources"/>
                                            </HyperlinkButton>


                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Grid>
            </Border>


            <!-- Bottom Section -->
            
            <StackPanel VerticalAlignment="Bottom" Grid.Row="1" Margin="12">
                <InfoBar
                    x:Name="PrimaryInfoBar"
                    IsOpen="False"
           
               
                    CornerRadius="8 8 0 0"
                    CloseButtonClick="ClickPrimaryInfoBar"/>
                <Border
                    x:Name="SaveBarBorder"
                    Background="{StaticResource AcrylicBackgroundFillColorBaseBrush}"
                    CornerRadius="8"
                    
                    >

                    <Grid ColumnSpacing="8" Padding="16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Grid>
              
                            <StackPanel x:Name="ReduceFileSizeCheckBoxTexts" Margin="35 -2 0 -2">
                                <TextBlock Grid.Column="1" Text="Reduce file size" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="If enabled, expect a bit slower generation"  Style="{StaticResource HelperTextStyle}"/>
                            </StackPanel>
                            <CheckBox x:Name="ReduceFileSizeCheckBox" Grid.Column="0" Content="" VerticalAlignment="Center"/>
                        </Grid>
                        
       
                        <Button x:Name="SaveAndGenerateButton" Grid.Column="4" Content="Generate Subject" MinWidth="120"/>
                    </Grid>
                </Border>
            </StackPanel>

        </Grid>
    </Grid>
</Window>
